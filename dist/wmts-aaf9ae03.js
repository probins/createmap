import{T as t,a as i,e,c as s,b as r}from"./TileImage-10f9535a.js";import{k as n}from"./size-aa14a1dc.js";import{a as o}from"./uri-6d91ca6a.js";class a extends t{constructor(t){super({extent:t.extent,origin:t.origin,origins:t.origins,resolutions:t.resolutions,tileSize:t.tileSize,tileSizes:t.tileSizes,sizes:t.sizes}),this.matrixIds_=t.matrixIds}getMatrixId(t){return this.matrixIds_[t]}getMatrixIds(){return this.matrixIds_}}var l="KVP";class c extends i{constructor(t){const i=void 0!==t.requestEncoding?t.requestEncoding:l,r=t.tileGrid;let n=t.urls;void 0===n&&void 0!==t.url&&(n=e(t.url)),super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,imageSmoothing:t.imageSmoothing,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:r,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,urls:n,wrapX:void 0!==t.wrapX&&t.wrapX,transition:t.transition}),this.version_=void 0!==t.version?t.version:"1.0.0",this.format_=void 0!==t.format?t.format:"image/jpeg",this.dimensions_=void 0!==t.dimensions?t.dimensions:{},this.layer_=t.layer,this.matrixSet_=t.matrixSet,this.style_=t.style,this.requestEncoding_=i,this.setKey(this.getKeyForDimensions_()),n&&n.length>0&&(this.tileUrlFunction=s(n.map(this.createFromWMTSTemplate.bind(this))))}setUrls(t){this.urls=t;const i=t.join("\n");this.setTileUrlFunction(s(t.map(this.createFromWMTSTemplate.bind(this))),i)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){let t=0;const i=[];for(const e in this.dimensions_)i[t++]=e+"-"+this.dimensions_[e];return i.join("/")}updateDimensions(t){n(this.dimensions_,t),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(t){const i=this.requestEncoding_,e={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};i==l&&n(e,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),t=i==l?o(t,e):t.replace(/\{(\w+?)\}/g,(function(t,i){return i.toLowerCase()in e?e[i.toLowerCase()]:t}));const s=this.tileGrid,r=this.dimensions_;return function(e,a,c){if(e){const a={TileMatrix:s.getMatrixId(e[0]),TileCol:e[1],TileRow:e[2]};n(a,r);let c=t;return c=i==l?o(c,a):c.replace(/\{(\w+?)\}/g,(function(t,i){return a[i]})),c}}}}function m(t){return t.sourceOptions.tileGrid=new a(t.tileGridOptions),[new r({id:t.id,extent:t.extent,source:new c(t.sourceOptions)})]}export{m as g};
