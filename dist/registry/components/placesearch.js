import{C as e,o as t}from"../../olMap-8ffb7ea3.js";import{$ as a}from"../../mapDef-32126832.js";import"./toolbar.js";import{aE as n}from"../../size-aa14a1dc.js";const o=new e('\n<template id="placesearchtemplate">\n  <div id="placesearch">\n    <div><button id="placesearchbutton">Go to</button> <input type="text" size="20" id="searchfor" placeholder="Enter placename">\n    <input type="text" size="10" id="placesearchapi" placeholder="Enter API key">\n    <input type="text" size="2" id="placesearchcontinent" placeholder="continent"></div>\n  </div>\n  <div id="searchResults"></div>\n</template>\n',"placesearch");a("#components-content").appendChild(o.getTemplate("placesearch"));const l=t.get();a("#placesearchbutton").addEventListener("click",(function(){const e=document.getElementById("searchfor").value,t=document.getElementById("placesearchapi").value,a=document.getElementById("placesearchcontinent").value;let o="https://secure.geonames.org/searchJSON?maxRows=10&username="+t+"&isNameRequired=true&style=full&q="+e;function s(e,t){let a=[e,t];const o=l.get("view");a=n(a,"EPSG:4326",o.getProjection());const s=o.extent;s[0]<=a[0]&&a[0]<=s[2]&&s[1]<=a[1]&&a[1]<=s[3]?(o.setCenter(a),o.setZoom(o.zoomIn)):alert("Coordinate outside map extent")}function c(e){s(parseFloat(this.dataset.lng),parseFloat(this.dataset.lat)),e.preventDefault()}a&&(o+="&continentCode="+a),o=o.replace(/amp;/g,""),fetch(o).then(e=>e.json()).then(e=>function(e){if(null===e)return void alert("Nothing returned from geonames.org");const t=e.geonames;if(0===t.length)return void alert("No such place on geonames.org");let a,n;if(1==t.length)a=parseFloat(t[0].lat),n=parseFloat(t[0].lng),s(n,a);else{let e="";for(let o=0;o<t.length;o++){const l=t[o];a=l.lat,n=l.lng,e+='<a href="#" class="gotos" data-lat="'+a+'" data-lng="'+n+'">'+l.name+", "+l.adminName1+", "+l.adminName2+", "+l.adminName3+", "+l.adminName4+"</a><br />"}document.getElementById("searchResults").innerHTML=e;const o=document.querySelectorAll(".gotos");for(let e=0;e<o.length;e++)o[e].addEventListener("click",c)}}(e)).catch(e=>{console.log(e),alert("Placesearch failed")})}));
