import e from"./addlayer.htm.js";import r from"./component.js";var t=new r(e,"addlayer");import a from"./ext/awesomplete.min.js";import o from"../../utils.js";var s=o.$;import i from"../../olMap.js";var l=i.get();import"./toolbar.js";s("#layers-content").appendChild(t.getTemplate("addlayer"));import d from"../sources/sourcelist.js";new a(document.querySelector("#rastercode"),{list:d,minChars:1});import n from"../../mapDef.js";var c=n.get();import m from"../../rasters.js";import v from"../../vectors.js";s("#addraster").addEventListener("click",(function(){var e=s("#rastercode").value;import("../sources/"+e+".js").then((function(r){var t;if(s("#api").value){t={rasters:[]};var a={};a[e]=s("#api").value,t.rasters.push(a)}m.add([r],t),c.rasters=c.rasters||[],c.rasters.push(e);var o=m.getLayers(),i=o.item(o.get("length")-1).getProperties().id;m.changeLayer.bind(l)(i);var d=s("#"+i.replace(/ |\(\)/g,""));d&&(d.checked=!0),s("#rastercode").value="",s("#api").value=""}))})),s("#addvector").addEventListener("click",(function(){var e={add:!0};if(!0===s("#mongodb").checked&&(e.format="mongo"),s("#vectorurl").value){var r=s("#vectorurl").value;e.url=r,e.id=s("#vectorname").value||r,o(e)}if(s("#vectorfile").files.length>0){var t=s("#vectorfile").files[0];e.type="file",e.filename=t.name,e.id=s("#vectorname").value||t.name;var a=new FileReader;a.onload=function(r){e.file=r.target.result,o(e)},a.readAsText(t)}function o(e){v.add({vectors:[e]}),0===m.getLayers().get("length")&&i.use4326View(),s("#vectorurl").value="",s("#fileform").reset(),delete e.add,c.vectors=c.vectors||[],c.vectors.push(e)}}));