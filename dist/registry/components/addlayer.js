import e from"./addlayer.htm.js";import t from"./component.js";import r from"./ext/awesomplete.min.js";import{$ as o}from"../../utils.js";import s from"../../olMap.js";import"./toolbar.js";import a from"../sources/sourcelist.js";import l from"../../mapDef.js";import c from"../../rasters.js";const i=new t(e,"addlayer");o("#layers-content").appendChild(i.getTemplate("addlayer"));const n=l.get();new r(document.querySelector("#rastercode"),{list:a,minChars:1});const d=s.get();o("#addraster").addEventListener("click",(()=>{const e=o("#rastercode").value;import("../sources/"+e+".js").then((t=>{let r;if(o("#api").value){r={rasters:[]};const t={};t[e]=o("#api").value,r.rasters.push(t)}c.add([t],r),n.rasters=n.rasters||[],n.rasters.push(e);const s=c.getLayers(),a=s.item(s.get("length")-1).getProperties().id;c.changeLayer.bind(d)(a);const l=o("#"+a.replace(/ |\(\)/g,""));l&&(l.checked=!0),o("#rastercode").value="",o("#api").value=""}))})),o("#addvector").addEventListener("click",(()=>{const e={add:!0};if(!0===o("#mongodb").checked&&(e.format="mongo"),o("#vectorurl").value){const r=o("#vectorurl").value;e.url=r,e.id=o("#vectorname").value||r,t(e)}if(o("#vectorfile").files.length>0){const r=o("#vectorfile").files[0];e.type="file",e.filename=r.name,e.id=o("#vectorname").value||r.name;const s=new FileReader;s.onload=r=>{e.file=r.target.result,t(e)},s.readAsText(r)}function t(e){import("../../vectors.js").then((t=>{t.default.add({vectors:[e]}),0===c.getLayers().get("length")&&s.use4326View(),o("#vectorurl").value="",o("#fileform").reset(),delete e.add,n.vectors=n.vectors||[],n.vectors.push(e)}))}}));