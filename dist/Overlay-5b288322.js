import{B as t,bg as e,n as i,aq as s,aj as n,u as o,l as a,bh as r,bi as h,a1 as d}from"./size-aa14a1dc.js";import{X as l}from"./olMap-5f1c27bb.js";var g="bottom-left",p="bottom-center",m="bottom-right",f="center-left",P="center-center",u="center-right",c="top-left",v="top-center",E="top-right";const C="element",b="map",y="offset",x="position",M="positioning";class O extends t{constructor(t){super(),this.options=t,this.id=t.id,this.insertFirst=void 0===t.insertFirst||t.insertFirst,this.stopEvent=void 0===t.stopEvent||t.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==t.className?t.className:"ol-overlay-container "+e,this.element.style.position="absolute",this.element.style.pointerEvents="auto";let s=t.autoPan;s&&"object"!=typeof s&&(s={animation:t.autoPanAnimation,margin:t.autoPanMargin}),this.autoPan=s||!1,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addEventListener(i(C),this.handleElementChanged),this.addEventListener(i(b),this.handleMapChanged),this.addEventListener(i(y),this.handleOffsetChanged),this.addEventListener(i(x),this.handlePositionChanged),this.addEventListener(i(M),this.handlePositioningChanged),void 0!==t.element&&this.setElement(t.element),this.setOffset(void 0!==t.offset?t.offset:[0,0]),this.setPositioning(void 0!==t.positioning?t.positioning:c),void 0!==t.position&&this.setPosition(t.position)}getElement(){return this.get(C)}getId(){return this.id}getMap(){return this.get(b)}getOffset(){return this.get(y)}getPosition(){return this.get(x)}getPositioning(){return this.get(M)}handleElementChanged(){s(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){this.mapPostrenderListenerKey&&(n(this.element),o(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=a(t,l.POSTRENDER,this.render,this),this.updatePixelPosition();const e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set(C,t)}setMap(t){this.set(b,t)}setOffset(t){this.set(y,t)}setPosition(t){this.set(x,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get(x))return;const i=this.getRect(e.getTargetElement(),e.getSize()),s=this.getElement(),n=this.getRect(s,[r(s),h(s)]),o=t||{},a=void 0===o.margin?20:o.margin;if(!d(i,n)){const t=n[0]-i[0],s=i[2]-n[2],r=n[1]-i[1],h=i[3]-n[3],d=[0,0];if(t<0?d[0]=t-a:s<0&&(d[0]=Math.abs(s)+a),r<0?d[1]=r-a:h<0&&(d[1]=Math.abs(h)+a),0!==d[0]||0!==d[1]){const t=e.getView().getCenterInternal(),i=e.getPixelFromCoordinateInternal(t);if(!i)return;const s=[i[0]+d[0],i[1]+d[1]],n=o.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(s),duration:n.duration,easing:n.easing})}}}getRect(t,e){const i=t.getBoundingClientRect(),s=i.left+window.pageXOffset,n=i.top+window.pageYOffset;return[s,n,s+e[0],n+e[1]]}setPositioning(t){this.set(M,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e)return void this.setVisible(!1);const i=t.getPixelFromCoordinate(e),s=t.getSize();this.updateRenderedPosition(i,s)}updateRenderedPosition(t,e){const i=this.element.style,s=this.getOffset(),n=this.getPositioning();this.setVisible(!0);const o=Math.round(t[0]+s[0])+"px",a=Math.round(t[1]+s[1])+"px";let r="0%",h="0%";n==m||n==u||n==E?r="-100%":n!=p&&n!=P&&n!=v||(r="-50%"),n==g||n==p||n==m?h="-100%":n!=f&&n!=P&&n!=u||(h="-50%");const d=`translate(${r}, ${h}) translate(${o}, ${a})`;this.rendered.transform_!=d&&(this.rendered.transform_=d,i.transform=d,i.msTransform=d)}getOptions(){return this.options}}export{O};
