import{m as t}from"./mapDef-32126832.js";import{a as e,c as i,g as n,D as s,b as o,d as r,m as a,i as h,T as l,l as c,O as d,e as u,C as g,R as _,u as p,f as m,S as f,r as v,B as y,A as E,h as C,j as x,k as R,n as w,o as M,p as I,E as T,q as P,s as b,t as L,P as S,v as A,w as N,x as D,y as O,z as F,F as K,G as V,H as z,I as k,U as Y,J as B,K as G,L as X,M as Z,N as H,Q as U,V as q,W as j,X as W,Y as Q,Z as $,_ as J,$ as tt,a0 as et,a1 as it,a2 as nt,a3 as st,a4 as ot,a5 as rt,a6 as at,a7 as ht,a8 as lt,a9 as ct,aa as dt,ab as ut,ac as gt,ad as _t,ae as pt,af as mt,ag as ft,ah as vt,ai as yt,aj as Et,ak as Ct,al as xt,am as Rt,an as wt,ao as Mt,ap as It,aq as Tt,ar as Pt,as as bt,at as Lt,au as St,av as At,aw as Nt,ax as Dt,ay as Ot,az as Ft,aA as Kt,aB as Vt,aC as zt,aD as kt,aE as Yt}from"./size-aa14a1dc.js";const Bt=t.get();function Gt(t,e){const i=document.createElement("div");i.innerHTML=t,this.templates={};const n=i.querySelectorAll("template");for(let t=0;t<n.length;t++)this.templates[n[t].getAttribute("id")]=document.importNode(n[t].content,!0);e&&(Bt.components=Bt.components||[],-1==Bt.components.indexOf(e)&&Bt.components.push(e),document.querySelector("#"+e+"button,#"+e+"option").style.display="none")}Gt.prototype.getTemplate=function(t){return this.templates[t+"template"]};const Xt=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Zt=/^([a-z]*)$|^hsla?\(.*\)$/i;function Ht(t){return"string"==typeof t?t:Wt(t)}const Ut=function(){const t={};let i=0;return function(n){let s;if(t.hasOwnProperty(n))s=t[n];else{if(i>=1024){let e=0;for(const n in t)0==(3&e++)&&(delete t[n],--i)}s=function(t){let i,n,s,o,r;Zt.exec(t)&&(t=function(t){const e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);const t=getComputedStyle(e).color;return document.body.removeChild(e),t}return""}(t));if(Xt.exec(t)){const e=t.length-1;let a;a=e<=4?1:2;const h=4===e||8===e;i=parseInt(t.substr(1+0*a,a),16),n=parseInt(t.substr(1+1*a,a),16),s=parseInt(t.substr(1+2*a,a),16),o=h?parseInt(t.substr(1+3*a,a),16):255,1==a&&(i=(i<<4)+i,n=(n<<4)+n,s=(s<<4)+s,h&&(o=(o<<4)+o)),r=[i,n,s,o/255]}else 0==t.indexOf("rgba(")?(r=t.slice(5,-1).split(",").map(Number),jt(r)):0==t.indexOf("rgb(")?(r=t.slice(4,-1).split(",").map(Number),r.push(1),jt(r)):e(!1,14);return r}(n),t[n]=s,++i}return s}}();function qt(t){return Array.isArray(t)?t:Ut(t)}function jt(t){return t[0]=i(t[0]+.5|0,0,255),t[1]=i(t[1]+.5|0,0,255),t[2]=i(t[2]+.5|0,0,255),t[3]=i(t[3],0,1),t}function Wt(t){let e=t[0];e!=(0|e)&&(e=e+.5|0);let i=t[1];i!=(0|i)&&(i=i+.5|0);let n=t[2];n!=(0|n)&&(n=n+.5|0);return"rgba("+e+","+i+","+n+","+(void 0===t[3]?1:t[3])+")"}function Qt(t,e,i){return e+":"+t+":"+(i?Ht(i):"null")}const $t=new class{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];0!=(3&t++)||i.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}}get(t,e,i){const n=Qt(t,e,i);return n in this.cache_?this.cache_[n]:null}set(t,e,i,n){const s=Qt(t,e,i);this.cache_[s]=n,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}};function Jt(t,e){const i=t[0],n=t[1],s=e[0],o=e[1],r=s[0],a=s[1],h=o[0],l=o[1],c=h-r,d=l-a,u=0===c&&0===d?0:(c*(i-r)+d*(n-a))/(c*c+d*d||0);let g,_;return u<=0?(g=r,_=a):u>=1?(g=h,_=l):(g=r+u*c,_=a+u*d),[g,_]}function te(t,e){let i=!0;for(let n=t.length-1;n>=0;--n)if(t[n]!=e[n]){i=!1;break}return i}function ee(t,e){const i=Math.cos(e),n=Math.sin(e),s=t[0]*i-t[1]*n,o=t[1]*i+t[0]*n;return t[0]=s,t[1]=o,t}function ie(t,e){const i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n}function ne(t,e){return Math.sqrt(ie(t,e))}function se(t,e){return ie(t,Jt(t,e))}function oe(t,e){if(e.canWrapX()){const i=n(e.getExtent()),s=function(t,e,i){const s=e.getExtent();let o=0;if(e.canWrapX()&&(t[0]<s[0]||t[0]>s[2])){const e=i||n(s);o=Math.floor((t[0]-s[0])/e)}return o}(t,e,i);s&&(t[0]-=s*i)}return t}class re extends s{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){o()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;r(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),a(n,i)}forEachFeatureAtCoordinate(t,e,i,s,o,r,a,l){let c;const d=e.viewState;function u(t,e,i,n){return o.call(r,e,t?i:null,n)}const g=d.projection,_=oe(t.slice(),g),p=[[0,0]];if(g.canWrapX()&&s){const t=g.getExtent(),e=n(t);p.push([-e,0],[e,0])}const m=e.layerStatesArray,f=m.length,v=[],y=[];for(let n=0;n<p.length;n++)for(let s=f-1;s>=0;--s){const o=m[s],r=o.layer;if(r.hasRenderer()&&h(o,d)&&a.call(l,r)){const s=r.getRenderer(),a=r.getSource();if(s&&a){const r=a.getWrapX()?_:t,h=u.bind(null,o.managed);y[0]=r[0]+p[n][0],y[1]=r[1]+p[n][1],c=s.forEachFeatureAtCoordinate(y,e,i,h,v)}if(c)return c}}if(0===v.length)return;const E=1/v.length;return v.forEach((t,e)=>t.distanceSq+=e*E),v.sort((t,e)=>t.distanceSq-e.distanceSq),v.some(t=>c=t.callback(t.feature,t.layer,t.geometry)),c}forEachLayerAtPixel(t,e,i,n,s){return o()}hasFeatureAtCoordinate(t,e,i,n,s,o){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,n,l,this,s,o)}getMap(){return this.map_}renderFrame(t){o()}scheduleExpireIconCache(t){$t.canExpireCache()&&t.postRenderFunctions.push(ae)}}function ae(t,e){$t.expire()}class he extends re{constructor(t){super(t),this.fontChangeListenerKey_=c(u,d.PROPERTYCHANGE,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=g+" ol-layers";const i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const n=new _(t,void 0,e);i.dispatchEvent(n)}}disposeInternal(){p(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t)return void(this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1));this.calculateMatrices2D(t),this.dispatchRenderEvent(m.PRECOMPOSE,t);const e=t.layerStatesArray.sort((function(t,e){return t.zIndex-e.zIndex})),i=t.viewState;this.children_.length=0;const n=[];let s=null;for(let o=0,r=e.length;o<r;++o){const r=e[o];if(t.layerIndex=o,!h(r,i)||r.sourceState!=f.READY&&r.sourceState!=f.UNDEFINED)continue;const a=r.layer,l=a.render(t,s);l&&(l!==s&&(this.children_.push(l),s=l),"getDeclutter"in a&&n.push(a))}for(let e=n.length-1;e>=0;--e)n[e].renderDeclutter(t);v(this.element_,this.children_),this.dispatchRenderEvent(m.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}forEachLayerAtPixel(t,e,i,n,s){const o=e.viewState,r=e.layerStatesArray;for(let a=r.length-1;a>=0;--a){const l=r[a],c=l.layer;if(c.hasRenderer()&&h(l,o)&&s(c)){const s=c.getRenderer().getDataAtPixel(t,e,i);if(s){const t=n(c,s);if(t)return t}}}}}var le={ADD:"add",REMOVE:"remove"};const ce="length";class de extends C{constructor(t,e,i){super(t),this.element=e,this.index=i}}class ue extends y{constructor(t,e){super();const i=e||{};if(this.unique_=!!i.unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(ce)}insertAt(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new de(le.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new de(le.REMOVE,e,t)),e}setAt(t,e){const i=this.getLength();if(t<i){this.unique_&&this.assertUnique_(e,t);const i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new de(le.REMOVE,i,t)),this.dispatchEvent(new de(le.ADD,e,t))}else{for(let e=i;e<t;++e)this.insertAt(e,void 0);this.insertAt(t,e)}}updateLength_(){this.set(ce,this.array_.length)}assertUnique_(t,e){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new E(58)}}const ge="layers";class _e extends x{constructor(t){const i=t||{},n=R({},i);delete n.layers;let s=i.layers;super(n),this.layersListenerKeys_=[],this.listenerKeys_={},this.addEventListener(w(ge),this.handleLayersChanged_),s?Array.isArray(s)?s=new ue(s.slice(),{unique:!0}):e("function"==typeof s.getArray,43):s=new ue(void 0,{unique:!0}),this.setLayers(s)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(p),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(c(t,le.ADD,this.handleLayersAdd_,this),c(t,le.REMOVE,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(p);M(this.listenerKeys_);const e=t.getArray();for(let t=0,i=e.length;t<i;t++){const i=e[t];this.listenerKeys_[I(i)]=[c(i,d.PROPERTYCHANGE,this.handleLayerChange_,this),c(i,T.CHANGE,this.handleLayerChange_,this)]}this.changed()}handleLayersAdd_(t){const e=t.element;this.listenerKeys_[I(e)]=[c(e,d.PROPERTYCHANGE,this.handleLayerChange_,this),c(e,T.CHANGE,this.handleLayerChange_,this)],this.changed()}handleLayersRemove_(t){const e=t.element,i=I(e);this.listenerKeys_[i].forEach(p),delete this.listenerKeys_[i],this.changed()}getLayers(){return this.get(ge)}setLayers(t){this.set(ge,t)}getLayersArray(t){const e=void 0!==t?t:[];return this.getLayers().forEach((function(t){t.getLayersArray(e)})),e}getLayerStatesArray(t){const e=void 0!==t?t:[],i=e.length;this.getLayers().forEach((function(t){t.getLayerStatesArray(e)}));const n=this.getLayerState();for(let t=i,s=e.length;t<s;t++){const i=e[t];i.opacity*=n.opacity,i.visible=i.visible&&n.visible,i.maxResolution=Math.min(i.maxResolution,n.maxResolution),i.minResolution=Math.max(i.minResolution,n.minResolution),i.minZoom=Math.max(i.minZoom,n.minZoom),i.maxZoom=Math.min(i.maxZoom,n.maxZoom),void 0!==n.extent&&(void 0!==i.extent?i.extent=P(i.extent,n.extent):i.extent=n.extent)}return e}getSourceState(){return f.READY}}class pe extends C{constructor(t,e,i){super(t),this.map=e,this.frameState=void 0!==i?i:null}}class me extends pe{constructor(t,e,i,n,s){super(t,e,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==n&&n}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),this.originalEvent.stopPropagation()}}var fe={SINGLECLICK:"singleclick",CLICK:T.CLICK,DBLCLICK:T.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ve={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};class ye extends b{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e?e*L:L,this.down_=null;const i=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=c(i,ve.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=c(i,ve.POINTERMOVE,this.relayEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(T.TOUCHMOVE,this.boundHandleTouchMove_,!!S&&{passive:!1})}emulateClick_(t){let e=new me(fe.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new me(fe.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;const e=new me(fe.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)}updateActivePointers_(t){const e=t;e.type==fe.POINTERUP||e.type==fe.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==fe.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length}handlePointerUp_(t){this.updateActivePointers_(t);const e=new me(fe.POINTERUP,this.map_,t);this.dispatchEvent(e),this.emulateClicks_&&!e.propagationStopped&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(p),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_,this.updateActivePointers_(t);const e=new me(fe.POINTERDOWN,this.map_,t);if(this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(c(t,fe.POINTERMOVE,this.handlePointerMove_,this),c(t,fe.POINTERUP,this.handlePointerUp_,this),c(this.element_,fe.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(c(this.element_.getRootNode(),fe.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.dragging_=!0;const e=new me(fe.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}}relayEvent_(t){this.originalPointerMoveEvent_=t;const e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new me(t.type,this.map_,t,e))}handleTouchMove_(t){this.originalPointerMoveEvent_&&!this.originalPointerMoveEvent_.defaultPrevented||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(p(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(T.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(p(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(p),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}var Ee={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"},Ce="layergroup",xe="size",Re="target",we="view";const Me=1/0;class Ie extends class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,M(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i}enqueue(t){e(!(this.keyFunction_(t)in this.queuedElements_),31);const i=this.priorityFunction_(t);return i!=Me&&(this.elements_.push(t),this.priorities_.push(i),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,n=e.length,s=e[t],o=i[t],r=t;for(;t<n>>1;){const s=this.getLeftChildIndex_(t),o=this.getRightChildIndex_(t),r=o<n&&i[o]<i[s]?o:s;e[t]=e[r],i[t]=i[r],t=r}e[t]=s,i[t]=o,this.siftDown_(r,t)}siftDown_(t,e){const i=this.elements_,n=this.priorities_,s=i[e],o=n[e];for(;e>t;){const t=this.getParentIndex_(e);if(!(n[t]>o))break;i[e]=i[t],n[e]=n[t],e=t}i[e]=s,n[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let n=0;const s=e.length;let o,r,a;for(r=0;r<s;++r)o=e[r],a=t(o),a==Me?delete this.queuedElements_[this.keyFunction_(o)]:(i[n]=a,e[n++]=o);e.length=n,i.length=n,this.heapify_()}}{constructor(t,e){super((function(e){return t.apply(null,e)}),(function(t){return t[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);if(e){t[0].addEventListener(T.CHANGE,this.boundHandleTileChange_)}return e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(e.hifi&&i===A.LOADED||i===A.ERROR||i===A.EMPTY){e.removeEventListener(T.CHANGE,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i,n,s,o=0;for(;this.tilesLoading_<t&&o<e&&this.getCount()>0;)n=this.dequeue()[0],s=n.getKey(),i=n.getState(),i!==A.IDLE||s in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[s]=!0,++this.tilesLoading_,++o,n.load())}}var Te={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},Pe={ANIMATING:0,INTERACTING:1},be="center",Le="resolution",Se="rotation";function Ae(t,e,n){return function(s,o,r,a,h){if(s){const l=e?0:r[0]*o,c=e?0:r[1]*o,d=h?h[0]:0,u=h?h[1]:0;let g=t[0]+l/2+d,_=t[2]-l/2+d,p=t[1]+c/2+u,m=t[3]-c/2+u;g>_&&(g=(_+g)/2,_=g),p>m&&(p=(m+p)/2,m=p);let f=i(s[0],g,_),v=i(s[1],p,m);const y=30*o;return a&&n&&(f+=-y*Math.log(1+Math.max(0,g-s[0])/y)+y*Math.log(1+Math.max(0,s[0]-_)/y),v+=-y*Math.log(1+Math.max(0,p-s[1])/y)+y*Math.log(1+Math.max(0,s[1]-m)/y)),[f,v]}}}function Ne(t){return t}function De(t,e,i,s){const o=n(e)/i[0],r=D(e)/i[1];return s?Math.min(t,Math.max(o,r)):Math.min(t,Math.min(o,r))}function Oe(t,e,n){let s=Math.min(t,e);return s*=Math.log(1+50*Math.max(0,t/e-1))/50+1,n&&(s=Math.max(s,n),s/=Math.log(1+50*Math.max(0,n/t-1))/50+1),i(s,n/2,2*e)}function Fe(t,e,n,s,o){return function(r,a,h,l){if(void 0!==r){const a=s?De(t,s,h,o):t;return(void 0===n||n)&&l?Oe(r,a,e):i(r,e,a)}}}function Ke(t){return void 0!==t?0:void 0}function Ve(t){return void 0!==t?t:void 0}var ze={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};function ke(t,e,i,n,s,o){const r=o||[];let a=0;for(let o=e;o<i;o+=n){const e=t[o],i=t[o+1];r[a++]=s[0]*e+s[2]*i+s[4],r[a++]=s[1]*e+s[3]*i+s[5]}return o&&r.length!=a&&(r.length=a),r}function Ye(t,e,i,n,s,o,r){const a=r||[],h=Math.cos(s),l=Math.sin(s),c=o[0],d=o[1];let u=0;for(let s=e;s<i;s+=n){const e=t[s]-c,i=t[s+1]-d;a[u++]=c+e*h-i*l,a[u++]=d+e*l+i*h;for(let e=s+2;e<s+n;++e)a[u++]=t[e]}return r&&a.length!=u&&(a.length=u),a}function Be(t,e,i,n,s,o,r){const a=r||[];let h=0;for(let r=e;r<i;r+=n){a[h++]=t[r]+s,a[h++]=t[r+1]+o;for(let e=r+2;e<r+n;++e)a[h++]=t[e]}return r&&a.length!=h&&(a.length=h),a}const Ge=G();class Xe extends y{constructor(){super(),this.extent_=F(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=K((function(t,e,i){if(!i)return this.getSimplifiedGeometry(e);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)}))}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return o()}closestPointXY(t,e,i,n){return o()}containsXY(t,e){const i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){const i=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],i,1/0),i}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return o()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&V(t),this.extentRevision_=this.getRevision()}return z(this.extent_,t)}rotate(t,e){o()}scale(t,e,i){o()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return o()}getType(){return o()}applyTransform(t){o()}intersectsExtent(t){return o()}translate(t,e){o()}transform(t,e){const i=k(t),n=i.getUnits()==Y.TILE_PIXELS?function(t,n,s){const o=i.getExtent(),a=i.getWorldExtent(),h=D(a)/D(o);return r(Ge,a[0],a[3],h,-h,0,0,0),ke(t,0,t.length,s,Ge,n),B(i,e)(t,n,s)}:B(i,e);return this.applyTransform(n),this}}class Ze extends Xe{constructor(){super(),this.layout=ze.XY,this.stride=2,this.flatCoordinates=null}computeExtent(t){return X(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return o()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=He(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){o()}setLayout(t,e,i){let n;if(t)n=He(t);else{for(let t=0;t<i;++t){if(0===e.length)return this.layout=ze.XY,void(this.stride=2);e=e[0]}n=e.length,t=function(t){let e;2==t?e=ze.XY:3==t?e=ze.XYZ:4==t&&(e=ze.XYZM);return e}(n)}this.layout=t,this.stride=n}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();Ye(i,0,i.length,n,t,e,i),this.changed()}}scale(t,e,i){let n=e;void 0===n&&(n=t);let s=i;s||(s=Z(this.getExtent()));const o=this.getFlatCoordinates();if(o){const e=this.getStride();!function(t,e,i,n,s,o,r,a){const h=a||[],l=r[0],c=r[1];let d=0;for(let r=e;r<i;r+=n){const e=t[r]-l,i=t[r+1]-c;h[d++]=l+s*e,h[d++]=c+o*i;for(let e=r+2;e<r+n;++e)h[d++]=t[e]}a&&h.length!=d&&(h.length=d)}(o,0,o.length,e,t,n,s,o),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();Be(i,0,i.length,n,t,e,i),this.changed()}}}function He(t){let e;return t==ze.XY?e=2:t==ze.XYZ||t==ze.XYM?e=3:t==ze.XYZM&&(e=4),e}function Ue(t,e,i){const n=t.getFlatCoordinates();if(n){const s=t.getStride();return ke(n,0,n.length,s,e,i)}return null}function qe(t,e,i,n,s,o,r){const a=t[e],h=t[e+1],l=t[i]-a,c=t[i+1]-h;let d;if(0===l&&0===c)d=e;else{const u=((s-a)*l+(o-h)*c)/(l*l+c*c);if(u>1)d=i;else{if(u>0){for(let s=0;s<n;++s)r[s]=U(t[e+s],t[i+s],u);return void(r.length=n)}d=e}}for(let e=0;e<n;++e)r[e]=t[d+e];r.length=n}function je(t,e,i,n,s){let o=t[e],r=t[e+1];for(e+=n;e<i;e+=n){const i=t[e],n=t[e+1],a=H(o,r,i,n);a>s&&(s=a),o=i,r=n}return s}function We(t,e,i,n,s){for(let o=0,r=i.length;o<r;++o){const r=i[o];s=je(t,e,r,n,s),e=r}return s}function Qe(t,e,i,n,s){for(let o=0,r=i.length;o<r;++o){const r=i[o];s=We(t,e,r,n,s),e=r[r.length-1]}return s}function $e(t,e,i,n,s,o,r,a,h,l,c){if(e==i)return l;let d,u;if(0===s){if(u=H(r,a,t[e],t[e+1]),u<l){for(d=0;d<n;++d)h[d]=t[e+d];return h.length=n,u}return l}const g=c||[NaN,NaN];let _=e+n;for(;_<i;)if(qe(t,_-n,_,n,r,a,g),u=H(r,a,g[0],g[1]),u<l){for(l=u,d=0;d<n;++d)h[d]=g[d];h.length=n,_+=n}else _+=n*Math.max((Math.sqrt(u)-Math.sqrt(l))/s|0,1);if(o&&(qe(t,i-n,e,n,r,a,g),u=H(r,a,g[0],g[1]),u<l)){for(l=u,d=0;d<n;++d)h[d]=g[d];h.length=n}return l}function Je(t,e,i,n,s,o,r,a,h,l,c){const d=c||[NaN,NaN];for(let c=0,u=i.length;c<u;++c){const u=i[c];l=$e(t,e,u,n,s,o,r,a,h,l,d),e=u}return l}function ti(t,e,i,n,s,o,r,a,h,l,c){const d=c||[NaN,NaN];for(let c=0,u=i.length;c<u;++c){const u=i[c];l=Je(t,e,u,n,s,o,r,a,h,l,d),e=u[u.length-1]}return l}function ei(t,e,i,n){for(let n=0,s=i.length;n<s;++n)t[e++]=i[n];return e}function ii(t,e,i,n){for(let s=0,o=i.length;s<o;++s){const o=i[s];for(let i=0;i<n;++i)t[e++]=o[i]}return e}function ni(t,e,i,n,s){const o=s||[];let r=0;for(let s=0,a=i.length;s<a;++s){const a=ii(t,e,i[s],n);o[r++]=a,e=a}return o.length=r,o}function si(t,e,i,n,s){const o=s||[];let r=0;for(let s=0,a=i.length;s<a;++s){const a=ni(t,e,i[s],n,o[r]);o[r++]=a,e=a[a.length-1]}return o.length=r,o}function oi(t,e,i,n,s,o,r){const a=(i-e)/n;if(a<3){for(;e<i;e+=n)o[r++]=t[e],o[r++]=t[e+1];return r}const h=new Array(a);h[0]=1,h[a-1]=1;const l=[e,i-n];let c=0;for(;l.length>0;){const i=l.pop(),o=l.pop();let r=0;const a=t[o],d=t[o+1],u=t[i],g=t[i+1];for(let e=o+n;e<i;e+=n){const i=t[e],n=t[e+1],s=q(i,n,a,d,u,g);s>r&&(c=e,r=s)}r>s&&(h[(c-e)/n]=1,o+n<c&&l.push(o,c),c+n<i&&l.push(c,i))}for(let i=0;i<a;++i)h[i]&&(o[r++]=t[e+i*n],o[r++]=t[e+i*n+1]);return r}function ri(t,e,i,n,s,o,r,a){for(let h=0,l=i.length;h<l;++h){const l=i[h];r=oi(t,e,l,n,s,o,r),a.push(r),e=l}return r}function ai(t,e){return e*Math.round(t/e)}function hi(t,e,i,n,s,o,r){if(e==i)return r;let a,h,l=ai(t[e],s),c=ai(t[e+1],s);e+=n,o[r++]=l,o[r++]=c;do{if(a=ai(t[e],s),h=ai(t[e+1],s),(e+=n)==i)return o[r++]=a,o[r++]=h,r}while(a==l&&h==c);for(;e<i;){const i=ai(t[e],s),d=ai(t[e+1],s);if(e+=n,i==a&&d==h)continue;const u=a-l,g=h-c,_=i-l,p=d-c;u*p==g*_&&(u<0&&_<u||u==_||u>0&&_>u)&&(g<0&&p<g||g==p||g>0&&p>g)?(a=i,h=d):(o[r++]=a,o[r++]=h,l=a,c=h,a=i,h=d)}return o[r++]=a,o[r++]=h,r}function li(t,e,i,n,s,o,r,a){for(let h=0,l=i.length;h<l;++h){const l=i[h];r=hi(t,e,l,n,s,o,r),a.push(r),e=l}return r}function ci(t,e,i,n,s,o,r,a){for(let h=0,l=i.length;h<l;++h){const l=i[h],c=[];r=li(t,e,l,n,s,o,r,c),a.push(c),e=l[l.length-1]}return r}function di(t,e,i,n,s){const o=void 0!==s?s:[];let r=0;for(let s=e;s<i;s+=n)o[r++]=t.slice(s,s+n);return o.length=r,o}function ui(t,e,i,n,s){const o=void 0!==s?s:[];let r=0;for(let s=0,a=i.length;s<a;++s){const a=i[s];o[r++]=di(t,e,a,n,o[r]),e=a}return o.length=r,o}function gi(t,e,i,n,s){const o=void 0!==s?s:[];let r=0;for(let s=0,a=i.length;s<a;++s){const a=i[s];o[r++]=ui(t,e,a,n,o[r]),e=a[a.length-1]}return o.length=r,o}function _i(t,e,i,n){let s=0,o=t[i-n],r=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];s+=r*i-o*n,o=i,r=n}return s/2}function pi(t,e,i,n){let s=0;for(let o=0,r=i.length;o<r;++o){const r=i[o];s+=_i(t,e,r,n),e=r}return s}function mi(t,e,i,n){let s=0;for(let o=0,r=i.length;o<r;++o){const r=i[o];s+=pi(t,e,r,n),e=r[r.length-1]}return s}class fi extends Ze{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new fi(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,n){return n<j(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(je(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),$e(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))}getArea(){return _i(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return di(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=oi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new fi(e,ze.XY)}getType(){return Te.LINEAR_RING}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ii(this.flatCoordinates,0,t,this.stride),this.changed()}}class vi extends Ze{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new vi(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const s=this.flatCoordinates,o=H(t,e,s[0],s[1]);if(o<n){const t=this.stride;for(let e=0;e<t;++e)i[e]=s[e];return i.length=t,o}return n}getCoordinates(){return this.flatCoordinates?this.flatCoordinates.slice():[]}computeExtent(t){return W(this.flatCoordinates,t)}getType(){return Te.POINT}intersectsExtent(t){return Q(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ei(this.flatCoordinates,0,t,this.stride),this.changed()}}function yi(t,e,i,n,s){return!$(s,(function(s){return!Ei(t,e,i,n,s[0],s[1])}))}function Ei(t,e,i,n,s,o){let r=0,a=t[i-n],h=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];h<=o?n>o&&(i-a)*(o-h)-(s-a)*(n-h)>0&&r++:n<=o&&(i-a)*(o-h)-(s-a)*(n-h)<0&&r--,a=i,h=n}return 0!==r}function Ci(t,e,i,n,s,o){if(0===i.length)return!1;if(!Ei(t,e,i[0],n,s,o))return!1;for(let e=1,r=i.length;e<r;++e)if(Ei(t,i[e-1],i[e],n,s,o))return!1;return!0}function xi(t,e,i,n,s,o){if(0===i.length)return!1;for(let r=0,a=i.length;r<a;++r){const a=i[r];if(Ci(t,e,a,n,s,o))return!0;e=a[a.length-1]}return!1}function Ri(t,e,i,n,s,o,r){let a,h,l,c,d,u,g;const _=s[o+1],p=[];for(let s=0,o=i.length;s<o;++s){const o=i[s];for(c=t[o-n],u=t[o-n+1],a=e;a<o;a+=n)d=t[a],g=t[a+1],(_<=u&&g<=_||u<=_&&_<=g)&&(l=(_-u)/(g-u)*(d-c)+c,p.push(l)),c=d,u=g}let m=NaN,f=-1/0;for(p.sort(J),c=p[0],a=1,h=p.length;a<h;++a){d=p[a];const s=Math.abs(d-c);s>f&&(l=(c+d)/2,Ci(t,e,i,n,l,_)&&(m=l,f=s)),c=d}return isNaN(m)&&(m=s[o]),r?(r.push(m,_,f),r):[m,_,f]}function wi(t,e,i,n,s){let o=[];for(let r=0,a=i.length;r<a;++r){const a=i[r];o=Ri(t,e,a,n,s,2*r,o),e=a[a.length-1]}return o}function Mi(t,e,i,n,s){const o=[t[e],t[e+1]],r=[];let a;for(;e+n<i;e+=n){if(r[0]=t[e+n],r[1]=t[e+n+1],a=s(o,r),a)return a;o[0]=r[0],o[1]=r[1]}return!1}function Ii(t,e,i,n,s){const o=tt(F(),t,e,i,n);return!!et(s,o)&&(!!it(s,o)||(o[0]>=s[0]&&o[2]<=s[2]||(o[1]>=s[1]&&o[3]<=s[3]||Mi(t,e,i,n,(function(t,e){return nt(s,t,e)})))))}function Ti(t,e,i,n,s){for(let o=0,r=i.length;o<r;++o){if(Ii(t,e,i[o],n,s))return!0;e=i[o]}return!1}function Pi(t,e,i,n,s){if(!function(t,e,i,n,s){return!!(Ii(t,e,i,n,s)||Ei(t,e,i,n,s[0],s[1])||Ei(t,e,i,n,s[0],s[3])||Ei(t,e,i,n,s[2],s[1])||Ei(t,e,i,n,s[2],s[3]))}(t,e,i[0],n,s))return!1;if(1===i.length)return!0;for(let e=1,o=i.length;e<o;++e)if(yi(t,i[e-1],i[e],n,s)&&!Ii(t,i[e-1],i[e],n,s))return!1;return!0}function bi(t,e,i,n,s){for(let o=0,r=i.length;o<r;++o){const r=i[o];if(Pi(t,e,r,n,s))return!0;e=r[r.length-1]}return!1}function Li(t,e,i,n){for(;e<i-n;){for(let s=0;s<n;++s){const o=t[e+s];t[e+s]=t[i-n+s],t[i-n+s]=o}e+=n,i-=n}}function Si(t,e,i,n){let s=0,o=t[i-n],r=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];s+=(i-o)*(n+r),o=i,r=n}return 0===s?void 0:s>0}function Ai(t,e,i,n,s){const o=void 0!==s&&s;for(let s=0,r=i.length;s<r;++s){const r=i[s],a=Si(t,e,r,n);if(0===s){if(o&&a||!o&&!a)return!1}else if(o&&!a||!o&&a)return!1;e=r}return!0}function Ni(t,e,i,n,s){for(let o=0,r=i.length;o<r;++o){const r=i[o];if(!Ai(t,e,r,n,s))return!1;r.length&&(e=r[r.length-1])}return!0}function Di(t,e,i,n,s){const o=void 0!==s&&s;for(let s=0,r=i.length;s<r;++s){const r=i[s],a=Si(t,e,r,n);(0===s?o&&a||!o&&!a:o&&!a||!o&&a)&&Li(t,e,r,n),e=r}return e}function Oi(t,e,i,n,s){for(let o=0,r=i.length;o<r;++o)e=Di(t,e,i[o],n,s);return e}class Fi extends Ze{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?st(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Fi(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<j(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(We(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Je(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return Ci(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return pi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Di(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,ui(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=Z(this.getExtent());this.flatInteriorPoint_=Ri(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new vi(this.getFlatInteriorPoint(),ze.XYM)}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new fi(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let s=0;for(let o=0,r=i.length;o<r;++o){const r=i[o],a=new fi(e.slice(s,r),t);n.push(a),s=r}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Ai(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Di(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=li(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new Fi(e,ze.XY,i)}getType(){return Te.POLYGON}intersectsExtent(t){return Pi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=ni(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===i.length?0:i[i.length-1],this.changed()}}function Ki(t){const e=t[0],i=t[1],n=t[2],s=t[3],o=[e,i,e,s,n,s,n,i,e,i];return new Fi(o,ze.XY,[o.length])}class Vi extends y{constructor(t){super();const e=R({},t);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=ot(e.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.cancelAnchor_=void 0,e.center&&(e.center=rt(e.center,this.projection_)),e.extent&&(e.extent=at(e.extent,this.projection_)),this.applyOptions_(e)}applyOptions_(t){const e=function(t){let e,s,o;const r=28,a=2;let h=void 0!==t.minZoom?t.minZoom:0,l=void 0!==t.maxZoom?t.maxZoom:r;const c=void 0!==t.zoomFactor?t.zoomFactor:a,d=void 0!==t.multiWorld&&t.multiWorld,u=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,g=void 0!==t.showFullExtent&&t.showFullExtent,_=ot(t.projection,"EPSG:3857"),p=_.getExtent();let m=t.constrainOnlyCenter,f=t.extent;d||f||!_.isGlobal()||(m=!1,f=p);if(void 0!==t.resolutions){const n=t.resolutions;s=n[h],o=void 0!==n[l]?n[l]:n[n.length-1],e=t.constrainResolution?function(t,e,n,s){return function(o,r,a,h){if(void 0!==o){const l=t[0],c=t[t.length-1],d=n?De(l,n,a,s):l;if(h)return void 0===e||e?Oe(o,d,c):i(o,c,d);const u=Math.min(d,o),g=Math.floor(N(t,u,r));return t[g]>d&&g<t.length-1?t[g+1]:t[g]}}}(n,u,!m&&f,g):Fe(s,o,u,!m&&f,g)}else{const d=(p?Math.max(n(p),D(p)):360*mt[Y.DEGREES]/_.getMetersPerUnit())/ft/Math.pow(a,0),v=d/Math.pow(a,r-0);s=t.maxResolution,void 0!==s?h=0:s=d/Math.pow(c,h),o=t.minResolution,void 0===o&&(o=void 0!==t.maxZoom?void 0!==t.maxResolution?s/Math.pow(c,l):d/Math.pow(c,l):v),l=h+Math.floor(Math.log(s/o)/Math.log(c)),o=s/Math.pow(c,l-h),e=t.constrainResolution?function(t,e,n,s,o,r){return function(a,h,l,c){if(void 0!==a){const d=o?De(e,o,l,r):e,u=void 0!==n?n:0;if(c)return void 0===s||s?Oe(a,d,u):i(a,u,d);const g=1e-9,_=Math.ceil(Math.log(e/d)/Math.log(t)-g),p=-h*(.5-g)+.5,m=Math.min(d,a),f=Math.floor(Math.log(e/m)/Math.log(t)+p),v=Math.max(_,f),y=e/Math.pow(t,v);return i(y,u,d)}}}(c,s,o,u,!m&&f,g):Fe(s,o,u,!m&&f,g)}return{constraint:e,maxResolution:s,minResolution:o,minZoom:h,zoomFactor:c}}(t);this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.padding=t.padding,this.minZoom_=e.minZoom;const s=function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return Ae(t.extent,t.constrainOnlyCenter,e)}const e=ot(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,Ae(t,!1,!1)}return Ne}(t),o=e.constraint,r=function(t){if(void 0===t.enableRotation||t.enableRotation){const e=t.constrainRotation;return void 0===e||!0===e?function(t){const e=t||O(5);return function(t,i){return i?t:void 0!==t?Math.abs(t)<=e?0:t:void 0}}():!1===e?Ve:"number"==typeof e?function(t){const e=2*Math.PI/t;return function(t,i){return i?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):Ve}return Ke}(t);this.constraints_={center:s,resolution:o,rotation:r},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.setProperties({}),this.options_=t}getUpdatedOptions_(t){const e=R({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),R({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let t=0;t<e.length;++t){let i=arguments[t];i.center&&(i=R({},i),i.center=rt(i.center,this.getProjection())),i.anchor&&(i=R({},i),i.anchor=rt(i.anchor,this.getProjection())),e[t]=i}this.animateInternal.apply(this,e)}animateInternal(t){let e,i=arguments.length;if(i>1&&"function"==typeof arguments[i-1]&&(e=arguments[i-1],--i),!this.isDef()){const t=arguments[i-1];return t.center&&this.setCenterInternal(t.center),void 0!==t.zoom&&this.setZoom(t.zoom),void 0!==t.rotation&&this.setRotation(t.rotation),void(e&&zi(e,!0))}let n=Date.now(),s=this.targetCenter_.slice(),o=this.targetResolution_,r=this.targetRotation_;const a=[];for(let t=0;t<i;++t){const i=arguments[t],h={start:n,complete:!1,anchor:i.anchor,duration:void 0!==i.duration?i.duration:1e3,easing:i.easing||ht,callback:e};if(i.center&&(h.sourceCenter=s,h.targetCenter=i.center.slice(),s=h.targetCenter),void 0!==i.zoom?(h.sourceResolution=o,h.targetResolution=this.getResolutionForZoom(i.zoom),o=h.targetResolution):i.resolution&&(h.sourceResolution=o,h.targetResolution=i.resolution,o=h.targetResolution),void 0!==i.rotation){h.sourceRotation=r;const t=lt(i.rotation-r+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=r+t,r=h.targetRotation}ki(h)?h.complete=!0:n+=h.duration,a.push(h)}this.animations_.push(a),this.setHint(Pe.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Pe.ANIMATING]>0}getInteracting(){return this.hints_[Pe.INTERACTING]>0}cancelAnimations(){let t;this.setHint(Pe.ANIMATING,-this.hints_[Pe.ANIMATING]);for(let e=0,i=this.animations_.length;e<i;++e){const i=this.animations_[e];if(i[0].callback&&zi(i[0].callback,!1),!t)for(let e=0,n=i.length;e<n;++e){const n=i[e];if(!n.complete){t=n.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let s=!0;for(let i=0,o=n.length;i<o;++i){const o=n[i];if(o.complete)continue;const r=t-o.start;let a=o.duration>0?r/o.duration:1;a>=1?(o.complete=!0,a=1):s=!1;const h=o.easing(a);if(o.sourceCenter){const t=o.sourceCenter[0],e=o.sourceCenter[1],i=t+h*(o.targetCenter[0]-t),n=e+h*(o.targetCenter[1]-e);this.targetCenter_=[i,n]}if(o.sourceResolution&&o.targetResolution){const t=1===h?o.targetResolution:o.sourceResolution+h*(o.targetResolution-o.sourceResolution);if(o.anchor){const e=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(t,0,e,!0);this.targetCenter_=this.calculateCenterZoom(i,o.anchor)}this.targetResolution_=t,this.applyTargetState_(!0)}if(void 0!==o.sourceRotation&&void 0!==o.targetRotation){const t=1===h?lt(o.targetRotation+Math.PI,2*Math.PI)-Math.PI:o.sourceRotation+h*(o.targetRotation-o.sourceRotation);if(o.anchor){const e=this.constraints_.rotation(t,!0);this.targetCenter_=this.calculateCenterRotate(e,o.anchor)}this.targetRotation_=t}if(this.applyTargetState_(!0),e=!0,!o.complete)break}if(s){this.animations_[i]=null,this.setHint(Pe.ANIMATING,-1);const t=n[0].callback;t&&zi(t,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const n=this.getCenterInternal();var s,o;return void 0!==n&&(i=[n[0]-e[0],n[1]-e[1]],ee(i,t-this.getRotation()),o=e,(s=i)[0]+=+o[0],s[1]+=+o[1]),i}calculateCenterZoom(t,e){let i;const n=this.getCenterInternal(),s=this.getResolution();if(void 0!==n&&void 0!==s){i=[e[0]-t*(e[0]-n[0])/s,e[1]-t*(e[1]-n[1])/s]}return i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t?ct(t,this.getProjection()):t}getCenterInternal(){return this.get(be)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.options_.constrainResolution}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return dt(e,this.getProjection())}calculateExtentInternal(t){const i=t||this.getViewportSize_(),n=this.getCenterInternal();e(n,1);const s=this.getResolution();e(void 0!==s,2);const o=this.getRotation();return e(void 0!==o,3),ut(n,s,o,i)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Le)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(at(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){const i=e||this.getViewportSize_(),s=n(t)/i[0],o=D(t)/i[1];return Math.max(s,o)}getResolutionForValueFunction(t){const e=t||2,i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,s=Math.log(i/n)/Math.log(e);return function(t){return i/Math.pow(e,t*s)}}getRotation(){return this.get(Se)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,s=Math.log(i/n)/e;return function(t){return Math.log(i/t)/e/s}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const s=this.padding;if(s){const t=this.getViewportSizeMinusPadding_();n=Yi(n,this.getViewportSize_(),[t[0]/2+s[3],t[1]/2+s[0]],e,i)}return{center:n.slice(0),projection:void 0!==t?t:null,resolution:e,rotation:i,zoom:this.getZoom()}}getZoom(){let t;const e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e,i,n=this.minZoom_||0;if(this.resolutions_){const s=N(this.resolutions_,t,1);n=s,e=this.resolutions_[s],i=s==this.resolutions_.length-1?2:e/this.resolutions_[s+1]}else e=this.maxResolution_,i=this.zoomFactor_;return n+Math.log(e/t)/Math.log(i)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=i(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,i(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,i){let n;if(e(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t)){e(!gt(t),25);n=Ki(at(t,this.getProjection()))}else if(t.getType()===Te.CIRCLE){const e=at(t.getExtent(),this.getProjection());n=Ki(e),n.rotate(this.getRotation(),Z(e))}else n=t;this.fitInternal(n,i)}fitInternal(t,e){const i=e||{};let n=i.size;n||(n=this.getViewportSizeMinusPadding_());const s=void 0!==i.padding?i.padding:[0,0,0,0],o=void 0!==i.nearest&&i.nearest;let r;r=void 0!==i.minResolution?i.minResolution:void 0!==i.maxZoom?this.getResolutionForZoom(i.maxZoom):0;const a=t.getFlatCoordinates(),h=this.getRotation(),l=Math.cos(-h);let c=Math.sin(-h),d=1/0,u=1/0,g=-1/0,_=-1/0;const p=t.getStride();for(let t=0,e=a.length;t<e;t+=p){const e=a[t]*l-a[t+1]*c,i=a[t]*c+a[t+1]*l;d=Math.min(d,e),u=Math.min(u,i),g=Math.max(g,e),_=Math.max(_,i)}let m=this.getResolutionForExtentInternal([d,u,g,_],[n[0]-s[1]-s[3],n[1]-s[0]-s[2]]);m=isNaN(m)?r:Math.max(m,r),m=this.getConstrainedResolution(m,o?0:1),c=-c;let f=(d+g)/2,v=(u+_)/2;f+=(s[1]-s[3])/2*m,v+=(s[0]-s[2])/2*m;const y=f*l-v*c,E=v*l+f*c,C=this.getConstrainedCenter([y,E],m),x=i.callback?i.callback:_t;void 0!==i.duration?this.animateInternal({resolution:m,center:C,duration:i.duration,easing:i.easing},x):(this.targetResolution_=m,this.targetCenter_=C,this.applyTargetState_(!1,!0),zi(x,!0))}centerOn(t,e,i){this.centerOnInternal(rt(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(Yi(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,n){let s;const o=this.padding;if(o&&t){const r=this.getViewportSizeMinusPadding_(-i),a=Yi(t,n,[r[0]/2+o[3],r[1]/2+o[0]],e,i);s=[t[0]-a[0],t[1]-a[1]]}return s}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){const e=ct(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){const i=e&&rt(e,this.getProjection());this.adjustResolutionInternal(t,i)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),s=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(s,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=rt(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(rt(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),s=this.getViewportSize_(n),o=this.constraints_.resolution(this.targetResolution_,0,s,i),r=this.constraints_.center(this.targetCenter_,o,s,i,this.calculateCenterShift(this.targetCenter_,o,n,s));this.get(Se)!==n&&this.set(Se,n),this.get(Le)!==o&&this.set(Le,o),this.get(be)&&te(this.get(be),r)||this.set(be,r),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){const n=void 0!==t?t:200,s=e||0,o=this.constraints_.rotation(this.targetRotation_),r=this.getViewportSize_(o),a=this.constraints_.resolution(this.targetResolution_,s,r),h=this.constraints_.center(this.targetCenter_,a,r,!1,this.calculateCenterShift(this.targetCenter_,a,o,r));if(0===n&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=o,this.targetCenter_=h,void this.applyTargetState_();const l=i||(0===n?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===o&&this.getCenterInternal()&&te(this.getCenterInternal(),h)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:o,center:h,resolution:a,duration:n,easing:pt,anchor:l}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Pe.INTERACTING,1)}endInteraction(t,e,i){const n=i&&rt(i,this.getProjection());this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,i){this.setHint(Pe.INTERACTING,-1),this.resolveConstraints(t,e,i)}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){const i=e||0,n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,i,n)}}function zi(t,e){setTimeout((function(){t(e)}),0)}function ki(t){return!(t.sourceCenter&&t.targetCenter&&!te(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)}function Yi(t,e,i,n,s){const o=Math.cos(-s);let r=Math.sin(-s),a=t[0]*o-t[1]*r,h=t[1]*o+t[0]*r;a+=(e[0]/2-i[0])*n,h+=(i[1]-e[1]/2)*n,r=-r;return[a*o-h*r,h*o+a*r]}class Bi extends y{constructor(t){super();const i=function(t){let i=null;void 0!==t.keyboardEventTarget&&(i="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);const n={},s=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new _e({layers:t.layers});let o,r,a;n[Ce]=s,n[Re]=t.target,n[we]=void 0!==t.view?t.view:new Vi,void 0!==t.controls&&(Array.isArray(t.controls)?o=new ue(t.controls.slice()):(e("function"==typeof t.controls.getArray,47),o=t.controls));void 0!==t.interactions&&(Array.isArray(t.interactions)?r=new ue(t.interactions.slice()):(e("function"==typeof t.interactions.getArray,48),r=t.interactions));void 0!==t.overlays?Array.isArray(t.overlays)?a=new ue(t.overlays.slice()):(e("function"==typeof t.overlays.getArray,49),a=t.overlays):a=new ue;return{controls:o,interactions:r,keyboardEventTarget:i,overlays:a,values:n}}(t);this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:L,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(this),this.coordinateToPixelTransform_=G(),this.pixelToCoordinateTransform_=G(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=i.keyboardEventTarget,this.keyHandlerKeys_=null,this.controls=i.controls||new ue,this.interactions=i.interactions||new ue,this.overlays_=i.overlays,this.overlayIdIndex_={},this.renderer_=null,this.handleResize_,this.postRenderFunctions_=[],this.tileQueue_=new Ie(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addEventListener(w(Ce),this.handleLayerGroupChanged_),this.addEventListener(w(we),this.handleViewChanged_),this.addEventListener(w(xe),this.handleSizeChanged_),this.addEventListener(w(Re),this.handleTargetChanged_),this.setProperties(i.values),this.controls.forEach(function(t){t.setMap(this)}.bind(this)),this.controls.addEventListener(le.ADD,function(t){t.element.setMap(this)}.bind(this)),this.controls.addEventListener(le.REMOVE,function(t){t.element.setMap(null)}.bind(this)),this.interactions.forEach(function(t){t.setMap(this)}.bind(this)),this.interactions.addEventListener(le.ADD,function(t){t.element.setMap(this)}.bind(this)),this.interactions.addEventListener(le.REMOVE,function(t){t.element.setMap(null)}.bind(this)),this.overlays_.forEach(this.addOverlayInternal_.bind(this)),this.overlays_.addEventListener(le.ADD,function(t){this.addOverlayInternal_(t.element)}.bind(this)),this.overlays_.addEventListener(le.REMOVE,function(t){const e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}.bind(this))}createRenderer(){throw new Error("Use a map type that has a createRenderer method")}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_)return;const n=this.getCoordinateFromPixelInternal(t),s=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,o=void 0!==i.layerFilter?i.layerFilter:l,r=!1!==i.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,s,r,e,null,o,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,(function(t){i.push(t)}),e),i}forEachLayerAtPixel(t,e,i){if(!this.frameState_)return;const n=i||{},s=void 0!==n.hitTolerance?n.hitTolerance:0,o=n.layerFilter||l;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,s,e,o)}hasFeatureAtPixel(t,e){if(!this.frameState_)return!1;const i=this.getCoordinateFromPixelInternal(t),n=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:l,s=void 0!==e.hitTolerance?e.hitTolerance:0,o=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,s,o,n,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const e=this.viewport_.getBoundingClientRect(),i="changedTouches"in t?t.changedTouches[0]:t;return[i.clientX-e.left,i.clientY-e.top]}getTarget(){return this.get(Re)}getTargetElement(){const t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null}getCoordinateFromPixel(t){return ct(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?vt(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Ce)}getLayers(){return this.getLayerGroup().getLayers()}getLoading(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e].layer.getSource();if(i&&i.loading)return!0}return!1}getPixelFromCoordinate(t){const e=rt(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?vt(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(xe)}getView(){return this.get(we)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){return this.getTargetElement()?this.getTargetElement().ownerDocument:document}getTilePriority(t,e,i,n){return function(t,e,i,n,s){if(!t||!(i in t.wantedTiles))return Me;if(!t.wantedTiles[i][e.getKey()])return Me;const o=t.viewState.center,r=n[0]-o[0],a=n[1]-o[1];return 65536*Math.log(s)+Math.sqrt(r*r+a*a)/s}(this.frameState_,t,e,i,n)}handleBrowserEvent(t,e){const i=e||t.type,n=new me(i,this,t);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===ve.POINTERDOWN||i===T.WHEEL||i===T.KEYDOWN){const t=this.getOwnerDocument(),i=this.viewport_.getRootNode?this.viewport_.getRootNode():t,n="host"in i?i.elementFromPoint(e.clientX,e.clientY):e.target;if(this.overlayContainerStopEvent_.contains(n)||!(i===t?t.documentElement:i).contains(n))return}if(t.frameState=this.frameState_,!1!==this.dispatchEvent(t)){const e=this.getInteractions().getArray().slice();for(let i=e.length-1;i>=0;i--){const n=e[i];if(n.getMap()!==this||!n.getActive()||!this.getTargetElement())continue;if(!n.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let i=this.maxTilesLoading_,n=i;if(t){const e=t.viewHints;if(e[Pe.ANIMATING]||e[Pe.INTERACTING]){const e=!yt&&Date.now()-t.time>8;i=e?0:8,n=e?0:2}}e.getTilesLoading()<i&&(e.reprioritize(),e.loadMoreTiles(i,n))}!t||!this.hasListener(m.RENDERCOMPLETE)||t.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(m.RENDERCOMPLETE,t);const i=this.postRenderFunctions_;for(let e=0,n=i.length;e<n;++e)i[e](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){let t;if(this.getTarget()&&(t=this.getTargetElement()),this.mapBrowserEventHandler_){for(let t=0,e=this.keyHandlerKeys_.length;t<e;++t)p(this.keyHandlerKeys_[t]);this.keyHandlerKeys_=null,this.viewport_.removeEventListener(T.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(T.WHEEL,this.boundHandleBrowserEvent_),void 0!==this.handleResize_&&(removeEventListener(T.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,Et(this.viewport_)}if(t){t.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer()),this.mapBrowserEventHandler_=new ye(this,this.moveTolerance_);for(const t in fe)this.mapBrowserEventHandler_.addEventListener(fe[t],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(T.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(T.WHEEL,this.boundHandleBrowserEvent_,!!S&&{passive:!1});const e=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[c(e,T.KEYDOWN,this.handleBrowserEvent,this),c(e,T.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(T.RESIZE,this.handleResize_,!1))}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(p(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(p(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=c(t,d.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=c(t,T.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(p),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[c(t,d.PROPERTYCHANGE,this.render,this),c(t,T.CHANGE,this.render,this)]),this.render()}isRendered(){return!!this.frameState_}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const i=t[e].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),n=this.frameState_;let s=null;if(void 0!==e&&Ct(e)&&i&&i.isDef()){const n=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=i.getState();s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:ut(o.center,o.resolution,o.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:o,viewHints:n,wantedTiles:{}}}if(this.frameState_=s,this.renderer_.renderFrame(s),s){if(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),n){(!this.previousExtent_||!gt(this.previousExtent_)&&!xt(s.extent,this.previousExtent_))&&(this.dispatchEvent(new pe(Ee.MOVESTART,this,n)),this.previousExtent_=V(this.previousExtent_))}this.previousExtent_&&!s.viewHints[Pe.ANIMATING]&&!s.viewHints[Pe.INTERACTING]&&!xt(s.extent,this.previousExtent_)&&(this.dispatchEvent(new pe(Ee.MOVEEND,this,s)),Rt(s.extent,this.previousExtent_))}this.dispatchEvent(new pe(Ee.POSTRENDER,this,s)),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){this.set(Ce,t)}setSize(t){this.set(xe,t)}setTarget(t){this.set(Re,t)}setView(t){this.set(we,t)}updateSize(){const t=this.getTargetElement();if(t){const e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0);this.updateViewportSize_()}updateViewportSize_(){const t=this.getView();if(t){let e=void 0;const i=getComputedStyle(this.viewport_);i.width&&i.height&&(e=[parseInt(i.width,10),parseInt(i.height,10)]),t.setViewportSize(e)}}}class Gi extends y{constructor(t){super();const e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){Et(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&Et(this.element);for(let t=0,e=this.listenerKeys.length;t<e;++t)p(this.listenerKeys[t]);if(this.listenerKeys.length=0,this.map_=t,this.map_){(this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==_t&&this.listenerKeys.push(c(t,Ee.POSTRENDER,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}}class Xi extends Gi{constructor(t){const e=t||{};super({element:document.createElement("div"),render:e.render,target:e.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===e.collapsed||e.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==e.collapsible,this.collapsible_=void 0===e.collapsible||e.collapsible,this.collapsible_||(this.collapsed_=!1);const i=void 0!==e.className?e.className:"ol-attribution",n=void 0!==e.tipLabel?e.tipLabel:"Attributions",s=void 0!==e.expandClassName?e.expandClassName:i+"-expand",o=void 0!==e.collapseLabel?e.collapseLabel:"»",r=void 0!==e.collapseClassName?e.collapseClassName:i+"-collpase";"string"==typeof o?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=o,this.collapseLabel_.className=r):this.collapseLabel_=o;const a=void 0!==e.label?e.label:"i";"string"==typeof a?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=s):this.label_=a;const h=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,l=document.createElement("button");l.setAttribute("type","button"),l.title=n,l.appendChild(h),l.addEventListener(T.CLICK,this.handleClick_.bind(this),!1);const c=i+" "+g+" "+wt+(this.collapsed_&&this.collapsible_?" "+Mt:"")+(this.collapsible_?"":" ol-uncollapsible"),d=this.element;d.className=c,d.appendChild(this.ulElement_),d.appendChild(l),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e={},i=[];let n=!0;const s=t.layerStatesArray;for(let o=0,r=s.length;o<r;++o){const r=s[o];if(!h(r,t.viewState))continue;const a=r.layer.getSource();if(!a)continue;const l=a.getAttributions();if(!l)continue;const c=l(t);if(c)if(n=n&&!1!==a.getAttributionsCollapsible(),Array.isArray(c))for(let t=0,n=c.length;t<n;++t)c[t]in e||(i.push(c[t]),e[c[t]]=!0);else c in e||(i.push(c),e[c]=!0)}return this.overrideCollapsible_||this.setCollapsible(n),i}updateElement_(t){if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const e=this.collectSourceAttributions_(t),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!It(e,this.renderedAttributions_)){Tt(this.ulElement_);for(let t=0,i=e.length;t<i;++t){const i=document.createElement("li");i.innerHTML=e[t],this.ulElement_.appendChild(i)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Mt),this.collapsed_?Pt(this.collapseLabel_,this.label_):Pt(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}class Zi extends Gi{constructor(t){const e=t||{};super({element:document.createElement("div"),render:e.render,target:e.target});const i=void 0!==e.className?e.className:"ol-rotate",n=void 0!==e.label?e.label:"⇧",s=void 0!==e.compassClassName?e.compassClassName:"ol-compass";this.label_=null,"string"==typeof n?(this.label_=document.createElement("span"),this.label_.className=s,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(s));const o=e.tipLabel?e.tipLabel:"Reset rotation",r=document.createElement("button");r.className=i+"-reset",r.setAttribute("type","button"),r.title=o,r.appendChild(this.label_),r.addEventListener(T.CLICK,this.handleClick_.bind(this),!1);const a=i+" "+g+" "+wt,h=this.element;h.className=a,h.appendChild(r),this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,this.duration_=void 0!==e.duration?e.duration:250,this.autoHide_=void 0===e.autoHide||e.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(bt)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const t=this.getMap().getView();if(!t)return;const e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:pt}):t.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const t="rotate("+i+"rad)";if(this.autoHide_){const t=this.element.classList.contains(bt);t||0!==i?t&&0!==i&&this.element.classList.remove(bt):this.element.classList.add(bt)}this.label_.style.transform=t}this.rotation_=i}}class Hi extends Gi{constructor(t){const e=t||{};super({element:document.createElement("div"),target:e.target});const i=void 0!==e.className?e.className:"ol-zoom",n=void 0!==e.delta?e.delta:1,s=void 0!==e.zoomInClassName?e.zoomInClassName:i+"-in",o=void 0!==e.zoomOutClassName?e.zoomOutClassName:i+"-out",r=void 0!==e.zoomInLabel?e.zoomInLabel:"+",a=void 0!==e.zoomOutLabel?e.zoomOutLabel:"−",h=void 0!==e.zoomInTipLabel?e.zoomInTipLabel:"Zoom in",l=void 0!==e.zoomOutTipLabel?e.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=s,c.setAttribute("type","button"),c.title=h,c.appendChild("string"==typeof r?document.createTextNode(r):r),c.addEventListener(T.CLICK,this.handleClick_.bind(this,n),!1);const d=document.createElement("button");d.className=o,d.setAttribute("type","button"),d.title=l,d.appendChild("string"==typeof a?document.createTextNode(a):a),d.addEventListener(T.CLICK,this.handleClick_.bind(this,-n),!1);const u=i+" "+g+" "+wt,_=this.element;_.className=u,_.appendChild(c),_.appendChild(d),this.duration_=void 0!==e.duration?e.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const e=this.getMap().getView();if(!e)return;const i=e.getZoom();if(void 0!==i){const n=e.getConstrainedZoom(i+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:n,duration:this.duration_,easing:pt})):e.setZoom(n)}}}const Ui="degrees",qi="imperial",ji="nautical",Wi="metric",Qi="us",$i=[1,2,5];function Ji(t){const e=t||{},i=new ue;(void 0===e.zoom||e.zoom)&&i.push(new Hi(e.zoomOptions));(void 0===e.rotate||e.rotate)&&i.push(new Zi(e.rotateOptions));return(void 0===e.attribution||e.attribution)&&i.push(new Xi(e.attributionOptions)),i}var tn={ACTIVE:"active"};class en extends y{constructor(t){super(),t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(tn.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(tn.ACTIVE,t)}setMap(t){this.map_=t}}function nn(t,e,i,n){const s=t.getZoom();if(void 0===s)return;const o=t.getConstrainedZoom(s+e),r=t.getResolutionForZoom(o);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:r,anchor:i,duration:void 0!==n?n:250,easing:pt})}class sn extends en{constructor(t){super();const e=t||{};this.delta_=e.delta?e.delta:1,this.duration_=void 0!==e.duration?e.duration:250}handleEvent(t){let e=!1;if(t.type==fe.DBLCLICK){const i=t.originalEvent,n=t.map,s=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_;nn(n.getView(),o,s,this.duration_),i.preventDefault(),e=!0}return!e}}class on extends en{constructor(t){const e=t||{};super(e),e.handleDownEvent&&(this.handleDownEvent=e.handleDownEvent),e.handleDragEvent&&(this.handleDragEvent=e.handleDragEvent),e.handleMoveEvent&&(this.handleMoveEvent=e.handleMoveEvent),e.handleUpEvent&&(this.handleUpEvent=e.handleUpEvent),e.stopDown&&(this.stopDown=e.stopDown),this.handlingDownUpSequence=!1,this.trackedPointers_={},this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==fe.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==fe.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&this.targetPointers.length>0}}else if(t.type==fe.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==fe.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){if(function(t){const e=t.type;return e===fe.POINTERDOWN||e===fe.POINTERDRAG||e===fe.POINTERUP}(t)){const e=t.originalEvent,i=e.pointerId.toString();t.type==fe.POINTERUP?delete this.trackedPointers_[i]:(t.type==fe.POINTERDOWN||i in this.trackedPointers_)&&(this.trackedPointers_[i]=e),this.targetPointers=At(this.trackedPointers_)}}}function rn(t){const e=t.length;let i=0,n=0;for(let s=0;s<e;s++)i+=t[s].clientX,n+=t[s].clientY;return[i/e,n/e]}function an(t){const e=arguments;return function(t){let i=!0;for(let n=0,s=e.length;n<s&&(i=i&&e[n](t),i);++n);return i}}const hn=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},ln=function(t){const e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},cn=function(t){return!t.map.getTargetElement().hasAttribute("tabindex")||function(t){return t.target.getTargetElement().contains(document.activeElement)}(t)},dn=l,un=function(t){const e=t.originalEvent;return 0==e.button&&!(Dt&&Ot&&e.ctrlKey)},gn=Nt,_n=function(t){return t.type==fe.SINGLECLICK},pn=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},mn=function(t){const e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},fn=function(t){const e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},vn=function(t){const i=t.originalEvent;return e(void 0!==i,56),"mouse"==i.pointerType},yn=function(t){const i=t.originalEvent;return e(void 0!==i,56),i.isPrimary&&0===i.button};class En extends on{constructor(t){super({stopDown:Nt});const e=t||{};this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const i=e.condition?e.condition:an(pn,yn);this.condition_=e.onFocusOnly?an(cn,i):i,this.noKinetic_=!1}handleDragEvent(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());const e=this.targetPointers,i=rn(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const e=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],n=t.map.getView();!function(t,e){t[0]*=e,t[1]*=e}(e,n.getResolution()),ee(e,n.getRotation()),n.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=i,this.lastPointersCount_=e.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),n=this.kinetic_.getAngle(),s=i.getCenterInternal(),o=e.getPixelFromCoordinateInternal(s),r=e.getCoordinateFromPixelInternal([o[0]-t*Math.cos(n),o[1]-t*Math.sin(n)]);i.animateInternal({center:i.getConstrainedCenter(r),duration:500,easing:pt})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class Cn extends on{constructor(t){const e=t||{};super({stopDown:Nt}),this.condition_=e.condition?e.condition:ln,this.lastAngle_=void 0,this.duration_=void 0!==e.duration?e.duration:250}handleDragEvent(t){if(!vn(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===Ke)return;const n=e.getSize(),s=t.pixel,o=Math.atan2(n[1]/2-s[1],s[0]-n[0]/2);if(void 0!==this.lastAngle_){const t=o-this.lastAngle_;i.adjustRotationInternal(-t)}this.lastAngle_=o}handleUpEvent(t){if(!vn(t))return!0;return t.map.getView().endInteraction(this.duration_),!1}handleDownEvent(t){if(!vn(t))return!1;if(un(t)&&this.condition_(t)){return t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0}return!1}}class xn extends s{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,i=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);i[4]=i[0].slice(),this.geometry_?this.geometry_.setCoordinates([i]):this.geometry_=new Fi([i])}getGeometry(){return this.geometry_}}const Rn="boxstart",wn="boxdrag",Mn="boxend",In="boxcancel";class Tn extends C{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}class Pn extends on{constructor(t){super();const e=t||{};this.box_=new xn(e.className||"ol-dragbox"),this.minArea_=void 0!==e.minArea?e.minArea:64,e.onBoxEnd&&(this.onBoxEnd=e.onBoxEnd),this.startPixel_=null,this.condition_=e.condition?e.condition:un,this.boxEndCondition_=e.boxEndCondition?e.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const n=i[0]-e[0],s=i[1]-e[1];return n*n+s*s>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Tn(wn,t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new Tn(e?Mn:In,t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Tn(Rn,t.coordinate,t)),!0)}onBoxEnd(t){}}class bn extends Pn{constructor(t){const e=t||{};super({condition:e.condition?e.condition:mn,className:e.className||"ol-dragzoom",minArea:e.minArea}),this.duration_=void 0!==e.duration?e.duration:200,this.out_=void 0!==e.out&&e.out}onBoxEnd(t){const e=this.getMap(),i=e.getView(),n=e.getSize();let s=this.getGeometry().getExtent();if(this.out_){const t=i.calculateExtentInternal(n),o=Ft([e.getPixelFromCoordinateInternal(Kt(s)),e.getPixelFromCoordinateInternal(Vt(s))]),r=i.getResolutionForExtentInternal(o,n);zt(t,1/r),s=t}const o=i.getConstrainedResolution(i.getResolutionForExtentInternal(s,n)),r=i.getConstrainedCenter(Z(s),o);i.animateInternal({resolution:o,center:r,duration:this.duration_,easing:pt})}}var Ln=37,Sn=38,An=39,Nn=40;class Dn extends en{constructor(t){super();const e=t||{};this.defaultCondition_=function(t){return pn(t)&&fn(t)},this.condition_=void 0!==e.condition?e.condition:this.defaultCondition_,this.duration_=void 0!==e.duration?e.duration:100,this.pixelDelta_=void 0!==e.pixelDelta?e.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==T.KEYDOWN){const i=t.originalEvent,n=i.keyCode;if(this.condition_(t)&&(n==Nn||n==Ln||n==An||n==Sn)){const s=t.map.getView(),o=s.getResolution()*this.pixelDelta_;let r=0,a=0;n==Nn?a=-o:n==Ln?r=-o:n==An?r=o:a=o;const h=[r,a];ee(h,s.getRotation()),function(t,e,i){const n=t.getCenterInternal();if(n){const s=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==i?i:250,easing:St,center:t.getConstrainedCenter(s)})}}(s,h,this.duration_),i.preventDefault(),e=!0}}return!e}}class On extends en{constructor(t){super();const e=t||{};this.condition_=e.condition?e.condition:fn,this.delta_=e.delta?e.delta:1,this.duration_=void 0!==e.duration?e.duration:100}handleEvent(t){let e=!1;if(t.type==T.KEYDOWN||t.type==T.KEYPRESS){const i=t.originalEvent,n=i.charCode;if(this.condition_(t)&&(n=="+".charCodeAt(0)||n=="-".charCodeAt(0))){const s=t.map,o=n=="+".charCodeAt(0)?this.delta_:-this.delta_;nn(s.getView(),o,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}}class Fn{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;const s=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/n,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const Kn="trackpad",Vn="wheel";class zn extends en{constructor(t){const e=t||{};super(e),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==e.maxDelta?e.maxDelta:1,this.duration_=void 0!==e.duration?e.duration:250,this.timeout_=void 0!==e.timeout?e.timeout:80,this.useAnchor_=void 0===e.useAnchor||e.useAnchor,this.constrainResolution_=void 0!==e.constrainResolution&&e.constrainResolution;const i=e.condition?e.condition:dn;this.condition_=e.onFocusOnly?an(cn,i):i,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;this.getMap().getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==T.WHEEL)return!0;const e=t.map,i=t.originalEvent;let n;if(i.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==T.WHEEL&&(n=i.deltaY,kt&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(n/=L),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(n*=40)),0===n)return!1;this.lastDelta_=n;const s=Date.now();void 0===this.startTime_&&(this.startTime_=s),(!this.mode_||s-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(n)<4?Kn:Vn);const o=e.getView();if(this.mode_===Kn&&!o.getConstrainResolution()&&!this.constrainResolution_)return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(o.getAnimating()&&o.cancelAnimations(),o.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),o.adjustZoom(-n/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=s,!1;this.totalDelta_+=n;const r=Math.max(this.timeout_-(s-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,e),r),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let n=-i(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),nn(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}class kn extends on{constructor(t){const e=t||{},i=e;i.stopDown||(i.stopDown=Nt),super(i),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==e.threshold?e.threshold:.3,this.duration_=void 0!==e.duration?e.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],n=this.targetPointers[1],s=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){const t=s-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=s;const o=t.map,r=o.getView();if(r.getConstraints().rotation===Ke)return;const a=o.getViewport().getBoundingClientRect(),h=rn(this.targetPointers);h[0]-=a.left,h[1]-=a.top,this.anchor_=o.getCoordinateFromPixelInternal(h),this.rotating_&&(o.render(),r.adjustRotationInternal(e,this.anchor_))}handleUpEvent(t){if(this.targetPointers.length<2){return t.map.getView().endInteraction(this.duration_),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}class Yn extends on{constructor(t){const e=t||{},i=e;i.stopDown||(i.stopDown=Nt),super(i),this.anchor_=null,this.duration_=void 0!==e.duration?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],n=this.targetPointers[1],s=i.clientX-n.clientX,o=i.clientY-n.clientY,r=Math.sqrt(s*s+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/r),this.lastDistance_=r;const a=t.map,h=a.getView();1!=e&&(this.lastScaleDelta_=e);const l=a.getViewport().getBoundingClientRect(),c=rn(this.targetPointers);c[0]-=l.left,c[1]-=l.top,this.anchor_=a.getCoordinateFromPixelInternal(c),a.render(),h.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const e=t.map.getView(),i=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,i),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}var Bn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:global,Gn=function(){function t(t,n,s,o,r){!function t(i,n,s,o,r){for(;o>s;){if(o-s>600){var a=o-s+1,h=n-s+1,l=Math.log(a),c=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*c*(a-c)/a)*(h-a/2<0?-1:1);t(i,n,Math.max(s,Math.floor(n-h*c/a+d)),Math.min(o,Math.floor(n+(a-h)*c/a+d)),r)}var u=i[n],g=s,_=o;for(e(i,s,n),r(i[o],u)>0&&e(i,s,o);g<_;){for(e(i,g,_),g++,_--;r(i[g],u)<0;)g++;for(;r(i[_],u)>0;)_--}0===r(i[s],u)?e(i,s,_):e(i,++_,o),_<=n&&(s=_+1),n<=_&&(o=_-1)}}(t,n,s||0,o||t.length-1,r||i)}function e(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function i(t,e){return t<e?-1:t>e?1:0}var n=function(t){void 0===t&&(t=9),(this||Bn)._maxEntries=Math.max(4,t),(this||Bn)._minEntries=Math.max(2,Math.ceil(.4*(this||Bn)._maxEntries)),this.clear()};function s(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function o(t,e){r(t,0,t.children.length,e,t)}function r(t,e,i,n,s){s||(s=_(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(var o=e;o<i;o++){var r=t.children[o];a(s,t.leaf?n(r):r)}return s}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function h(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function d(t){return t.maxX-t.minX+(t.maxY-t.minY)}function u(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function g(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function _(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function p(e,i,n,s,o){for(var r=[i,n];r.length;)if(!((n=r.pop())-(i=r.pop())<=s)){var a=i+Math.ceil((n-i)/s/2)*s;t(e,a,i,n,o),r.push(i,a,a,n)}}return n.prototype.all=function(){return this._all((this||Bn).data,[])},n.prototype.search=function(t){var e=(this||Bn).data,i=[];if(!g(t,e))return i;for(var n=(this||Bn).toBBox,s=[];e;){for(var o=0;o<e.children.length;o++){var r=e.children[o],a=e.leaf?n(r):r;g(t,a)&&(e.leaf?i.push(r):u(t,a)?this._all(r,i):s.push(r))}e=s.pop()}return i},n.prototype.collides=function(t){var e=(this||Bn).data;if(!g(t,e))return!1;for(var i=[];e;){for(var n=0;n<e.children.length;n++){var s=e.children[n],o=e.leaf?this.toBBox(s):s;if(g(t,o)){if(e.leaf||u(t,o))return!0;i.push(s)}}e=i.pop()}return!1},n.prototype.load=function(t){if(!t||!t.length)return this||Bn;if(t.length<(this||Bn)._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this||Bn}var i=this._build(t.slice(),0,t.length-1,0);if((this||Bn).data.children.length)if((this||Bn).data.height===i.height)this._splitRoot((this||Bn).data,i);else{if((this||Bn).data.height<i.height){var n=(this||Bn).data;(this||Bn).data=i,i=n}this._insert(i,(this||Bn).data.height-i.height-1,!0)}else(this||Bn).data=i;return this||Bn},n.prototype.insert=function(t){return t&&this._insert(t,(this||Bn).data.height-1),this||Bn},n.prototype.clear=function(){return(this||Bn).data=_([]),this||Bn},n.prototype.remove=function(t,e){if(!t)return this||Bn;for(var i,n,o,r=(this||Bn).data,a=this.toBBox(t),h=[],l=[];r||h.length;){if(r||(r=h.pop(),n=h[h.length-1],i=l.pop(),o=!0),r.leaf){var c=s(t,r.children,e);if(-1!==c)return r.children.splice(c,1),h.push(r),this._condense(h),this||Bn}o||r.leaf||!u(r,a)?n?(i++,r=n.children[i],o=!1):r=null:(h.push(r),l.push(i),i=0,n=r,r=r.children[0])}return this||Bn},n.prototype.toBBox=function(t){return t},n.prototype.compareMinX=function(t,e){return t.minX-e.minX},n.prototype.compareMinY=function(t,e){return t.minY-e.minY},n.prototype.toJSON=function(){return(this||Bn).data},n.prototype.fromJSON=function(t){return(this||Bn).data=t,this||Bn},n.prototype._all=function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},n.prototype._build=function(t,e,i,n){var s,r=i-e+1,a=(this||Bn)._maxEntries;if(r<=a)return o(s=_(t.slice(e,i+1)),(this||Bn).toBBox),s;n||(n=Math.ceil(Math.log(r)/Math.log(a)),a=Math.ceil(r/Math.pow(a,n-1))),(s=_([])).leaf=!1,s.height=n;var h=Math.ceil(r/a),l=h*Math.ceil(Math.sqrt(a));p(t,e,i,l,(this||Bn).compareMinX);for(var c=e;c<=i;c+=l){var d=Math.min(c+l-1,i);p(t,c,d,h,(this||Bn).compareMinY);for(var u=c;u<=d;u+=h){var g=Math.min(u+h-1,d);s.children.push(this._build(t,u,g,n-1))}}return o(s,(this||Bn).toBBox),s},n.prototype._chooseSubtree=function(t,e,i,n){for(;n.push(e),!e.leaf&&n.length-1!==i;){for(var s=1/0,o=1/0,r=void 0,a=0;a<e.children.length;a++){var h=e.children[a],l=c(h),d=(u=t,g=h,(Math.max(g.maxX,u.maxX)-Math.min(g.minX,u.minX))*(Math.max(g.maxY,u.maxY)-Math.min(g.minY,u.minY))-l);d<o?(o=d,s=l<s?l:s,r=h):d===o&&l<s&&(s=l,r=h)}e=r||e.children[0]}var u,g;return e},n.prototype._insert=function(t,e,i){var n=i?t:this.toBBox(t),s=[],o=this._chooseSubtree(n,(this||Bn).data,e,s);for(o.children.push(t),a(o,n);e>=0&&s[e].children.length>(this||Bn)._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(n,s,e)},n.prototype._split=function(t,e){var i=t[e],n=i.children.length,s=(this||Bn)._minEntries;this._chooseSplitAxis(i,s,n);var r=this._chooseSplitIndex(i,s,n),a=_(i.children.splice(r,i.children.length-r));a.height=i.height,a.leaf=i.leaf,o(i,(this||Bn).toBBox),o(a,(this||Bn).toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)},n.prototype._splitRoot=function(t,e){(this||Bn).data=_([t,e]),(this||Bn).data.height=t.height+1,(this||Bn).data.leaf=!1,o((this||Bn).data,(this||Bn).toBBox)},n.prototype._chooseSplitIndex=function(t,e,i){for(var n,s,o,a,h,l,d,u=1/0,g=1/0,_=e;_<=i-e;_++){var p=r(t,0,_,(this||Bn).toBBox),m=r(t,_,i,(this||Bn).toBBox),f=(s=p,o=m,a=void 0,h=void 0,l=void 0,d=void 0,a=Math.max(s.minX,o.minX),h=Math.max(s.minY,o.minY),l=Math.min(s.maxX,o.maxX),d=Math.min(s.maxY,o.maxY),Math.max(0,l-a)*Math.max(0,d-h)),v=c(p)+c(m);f<u?(u=f,n=_,g=v<g?v:g):f===u&&v<g&&(g=v,n=_)}return n||i-e},n.prototype._chooseSplitAxis=function(t,e,i){var n=t.leaf?(this||Bn).compareMinX:h,s=t.leaf?(this||Bn).compareMinY:l;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,s)&&t.children.sort(n)},n.prototype._allDistMargin=function(t,e,i,n){t.children.sort(n);for(var s=(this||Bn).toBBox,o=r(t,0,e,s),h=r(t,i-e,i,s),l=d(o)+d(h),c=e;c<i-e;c++){var u=t.children[c];a(o,t.leaf?s(u):u),l+=d(o)}for(var g=i-e-1;g>=e;g--){var _=t.children[g];a(h,t.leaf?s(_):_),l+=d(h)}return l},n.prototype._adjustParentBBoxes=function(t,e,i){for(var n=i;n>=0;n--)a(e[n],t)},n.prototype._condense=function(t){for(var e=t.length-1,i=void 0;e>=0;e--)0===t[e].children.length?e>0?(i=t[e-1].children).splice(i.indexOf(t[e]),1):this.clear():o(t[e],(this||Bn).toBBox)},n}();const Xn={},Zn=new class extends Bi{constructor(t){(t=R({},t)).controls||(t.controls=Ji()),t.interactions||(t.interactions=function(t){const e=t||{},i=new ue,n=new Fn(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&i.push(new Cn),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&i.push(new sn({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&i.push(new En({onFocusOnly:e.onFocusOnly,kinetic:n})),(void 0===e.pinchRotate||e.pinchRotate)&&i.push(new kn),(void 0===e.pinchZoom||e.pinchZoom)&&i.push(new Yn({duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(i.push(new Dn),i.push(new On({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&i.push(new zn({onFocusOnly:e.onFocusOnly,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&i.push(new bn({duration:e.zoomDuration})),i}({onFocusOnly:!0})),super(t)}createRenderer(){return new he(this)}}({controls:Ji({attributionOptions:{collapsible:!1}}).extend([new class extends Gi{constructor(t){const e=t||{},i=void 0!==e.className?e.className:e.bar?"ol-scale-bar":"ol-scale-line";super({element:document.createElement("div"),render:e.render,target:e.target}),this.innerElement_=document.createElement("div"),this.innerElement_.className=i+"-inner",this.element.className=i+" "+g,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=void 0!==e.minWidth?e.minWidth:64,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addEventListener(w("units"),this.handleUnitsChanged_),this.setUnits(e.units||Wi),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get("units")}handleUnitsChanged_(){this.updateElement_()}setUnits(t){this.set("units",t)}setDpi(t){this.dpi_=t}updateElement_(){const t=this.viewState_;if(!t)return void(this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1));const i=t.center,n=t.projection,s=this.getUnits(),o=s==Ui?Y.DEGREES:Y.METERS;let r=Lt(n,t.resolution,i,o);const a=this.minWidth_*(this.dpi_||90.7142857142857)/90.7142857142857;let h=a*r,l="";if(s==Ui){const t=mt[Y.DEGREES];h*=t,h<t/60?(l="″",r*=3600):h<t?(l="′",r*=60):l="°"}else s==qi?h<.9144?(l="in",r/=.0254):h<1609.344?(l="ft",r/=.3048):(l="mi",r/=1609.344):s==ji?(r/=1852,l="nm"):s==Wi?h<.001?(l="μm",r*=1e6):h<1?(l="mm",r*=1e3):h<1e3?l="m":(l="km",r/=1e3):s==Qi?h<.9144?(l="in",r*=39.37):h<1609.344?(l="ft",r/=.30480061):(l="mi",r/=1609.3472):e(!1,33);let c,d,u,g,_=3*Math.floor(Math.log(a*r)/Math.log(10));for(;;){u=Math.floor(_/3);const t=Math.pow(10,u);if(c=$i[(_%3+3)%3]*t,d=Math.round(c/r),isNaN(d))return this.element.style.display="none",void(this.renderedVisible_=!1);if(d>=a)break;++_}g=this.scaleBar_?this.createScaleBar(d,c,l):c.toFixed(u<0?-u:0)+" "+l,this.renderedHTML_!=g&&(this.innerElement_.innerHTML=g,this.renderedHTML_=g),this.renderedWidth_!=d&&(this.innerElement_.style.width=d+"px",this.renderedWidth_=d),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(t,e,i){const n="1 : "+Math.round(this.getScaleForResolution()).toLocaleString(),s=[],o=t/this.scaleBarSteps_;let r,a="#ffffff";for(let n=0;n<this.scaleBarSteps_;n++)0===n&&s.push(this.createMarker("absolute",n)),s.push('<div><div class="ol-scale-singlebar" style="width: '+o+"px;background-color: "+a+';"></div>'+this.createMarker("relative",n)+(n%2==0||2===this.scaleBarSteps_?this.createStepText(n,t,!1,e,i):"")+"</div>"),n===this.scaleBarSteps_-1&&s.push(this.createStepText(n+1,t,!0,e,i)),a="#ffffff"===a?"#000000":"#ffffff";r=this.scaleBarText_?'<div class="ol-scale-text" style="width: '+t+'px;">'+n+"</div>":"";return'<div style="display: flex;">'+r+s.join("")+"</div>"}createMarker(t,e){return'<div class="ol-scale-step-marker" style="position: '+t+";top: "+("absolute"===t?3:-10)+'px;"></div>'}createStepText(t,e,i,n,s){const o=(0===t?0:Math.round(n/this.scaleBarSteps_*t*100)/100)+(0===t?"":" "+s);return'<div class="ol-scale-step-text" style="margin-left: '+(0===t?-3:e/this.scaleBarSteps_*-1)+"px;text-align: "+(0===t?"left":"center")+"; min-width: "+(0===t?0:e/this.scaleBarSteps_*2)+"px;left: "+(i?e+"px":"unset")+';">'+o+"</div>"}getScaleForResolution(){const t=Lt(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center),e=this.dpi_||90.7142857142857,i=this.viewState_.projection.getMetersPerUnit();return parseFloat(t.toString())*i*(1e3/25.4)*e}render(t){const e=t.frameState;this.viewState_=e?e.viewState:null,this.updateElement_()}}]),layers:[new _e({id:"rasters"}),new _e({id:"vectors"})],target:function(){const t=document.createElement("div");return t.id="map",document.body.appendChild(t),t}(),keyboardEventTarget:document});function Hn(t={},e,i,n){const s=i?[(i[0]+i[2])/2,(i[1]+i[3])/2]:[0,0],o={center:t.center?Yt([t.center.lon,t.center.lat],"EPSG:4326",e):s,zoom:t.zoom||0};return e&&(o.projection=e),n&&(o.resolutions=n,o.constrainResolution=!0),t.rotation&&(o.rotation=t.rotation),new Vi(o)}document.querySelector(".ol-zoom-in").addEventListener("click",(function(){this.blur()})),document.querySelector(".ol-zoom-out").addEventListener("click",(function(){this.blur()}));var Un={createView:Hn,views:Xn,use4326View:function(t){const e="EPSG:4326";Xn[e]=Hn(t,e),Zn.set("view",Xn[e])},get:function(){return Zn},addControl:function(t){document.body.appendChild(t.firstElementChild),Zn.addControl(new Gi({element:t.lastElementChild}))}};export{Be as $,wi as A,Ni as B,Gt as C,ci as D,Fi as E,bi as F,Te as G,si as H,en as I,Wt as J,qt as K,Gn as L,ai as M,Ye as N,ke as O,vi as P,Ue as Q,$t as R,Ze as S,Ht as T,oe as U,Pe as V,Xe as W,Ee as X,Gi as Y,ve as Z,ei as _,mn as a,on as a0,ie as a1,pn as a2,dn as a3,tn as a4,fe as a5,me as a6,yn as a7,hn as a8,ne as a9,te as aa,Jt as ab,se as ac,ue as b,le as c,$e as d,ze as e,Mi as f,oi as g,Ii as h,di as i,ii as j,We as k,Je as l,je as m,gn as n,Un as o,ui as p,ri as q,Ti as r,_n as s,ni as t,Qe as u,ti as v,xi as w,mi as x,Oi as y,gi as z};
